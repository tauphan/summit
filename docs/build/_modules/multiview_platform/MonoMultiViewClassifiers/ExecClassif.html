

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>multiview_platform.MonoMultiViewClassifiers.ExecClassif &mdash; MultiviewPlatform 0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> MultiviewPlatform
          

          
          </a>

          
            
            
              <div class="version">
                0.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../readme_link.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme_link.html#mono-and-multi-view-classification-benchmark">Mono- and Multi-view classification benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">Multiview Platform</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MultiviewPlatform</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>multiview_platform.MonoMultiViewClassifiers.ExecClassif</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for multiview_platform.MonoMultiViewClassifiers.ExecClassif</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pkgutil</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="k">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>
<span class="kn">import</span> <span class="nn">h5py</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>  <span class="c1"># Anti-Grain Geometry C++ library to make a raster (pixel) image of the figure</span>

<span class="c1"># Import own modules</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">MonoviewClassifiers</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">MultiviewClassifiers</span>
<span class="kn">from</span> <span class="nn">.Multiview.ExecMultiview</span> <span class="k">import</span> <span class="n">ExecMultiview</span><span class="p">,</span> <span class="n">ExecMultiview_multicore</span>
<span class="kn">from</span> <span class="nn">.Monoview.ExecClassifMonoView</span> <span class="k">import</span> <span class="n">ExecMonoview</span><span class="p">,</span> <span class="n">ExecMonoview_multicore</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">GetMultiviewDb</span> <span class="k">as</span> <span class="n">DB</span>
<span class="kn">from</span> <span class="nn">.ResultAnalysis</span> <span class="k">import</span> <span class="n">getResults</span>  <span class="c1">#resultAnalysis, analyzeLabels, analyzeIterResults, analyzeIterLabels, genNamesFromRes,</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">execution</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Multiclass</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">Metrics</span>

<span class="c1"># Author-Info</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Baptiste Bauvin&quot;</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s2">&quot;Prototype&quot;</span>  <span class="c1"># Production, Development, Prototype</span>


<div class="viewcode-block" id="initBenchmark"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.initBenchmark">[docs]</a><span class="k">def</span> <span class="nf">initBenchmark</span><span class="p">(</span><span class="n">CL_type</span><span class="p">,</span>  <span class="n">monoviewAlgos</span><span class="p">,</span> <span class="n">multiviewAlgos</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Used to create a list of all the algorithm packages names used for the benchmark.</span>

<span class="sd">    First this function will check if the benchmark need mono- or/and multiview algorithms and adds to the right</span>
<span class="sd">    dictionary the asked algorithms. If none is asked by the user, all will be added.</span>

<span class="sd">    If the keyword `&quot;Benchmark&quot;` is used, all mono- and multiview algorithms will be added.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    CL_type : List of string</span>
<span class="sd">        List of types of needed benchmark</span>
<span class="sd">    multiviewAlgos : List of strings</span>
<span class="sd">        List of multiview algorithms needed for the benchmark</span>
<span class="sd">    monoviewAlgos : Listof strings</span>
<span class="sd">        List of monoview algorithms needed for the benchmark</span>
<span class="sd">    args : ParsedArgumentParser args</span>
<span class="sd">        All the input args (used to tune the algorithms)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    benchmark : Dictionary of dictionaries</span>
<span class="sd">        Dictionary resuming which mono- and multiview algorithms which will be used in the benchmark.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">benchmark</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Monoview&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;Multiview&quot;</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="n">allMultiviewPackages</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">isPackage</span>
                            <span class="ow">in</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">iter_modules</span><span class="p">([</span><span class="s1">&#39;./MonoMultiViewClassifiers/MultiviewClassifiers/&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">isPackage</span><span class="p">]</span>

    <span class="k">if</span> <span class="s2">&quot;Monoview&quot;</span> <span class="ow">in</span> <span class="n">CL_type</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">monoviewAlgos</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]:</span>
            <span class="n">benchmark</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">isPackage</span> <span class="ow">in</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">iter_modules</span><span class="p">([</span><span class="s2">&quot;./MonoMultiViewClassifiers/MonoviewClassifiers&quot;</span><span class="p">])</span>
                                     <span class="k">if</span> <span class="ow">not</span> <span class="n">isPackage</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">benchmark</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">monoviewAlgos</span>

    <span class="k">if</span> <span class="s2">&quot;Multiview&quot;</span> <span class="ow">in</span> <span class="n">CL_type</span><span class="p">:</span>
        <span class="n">benchmark</span><span class="p">[</span><span class="s2">&quot;Multiview&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">multiviewAlgos</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]:</span>
            <span class="n">algosMutliview</span> <span class="o">=</span> <span class="n">allMultiviewPackages</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">algosMutliview</span> <span class="o">=</span> <span class="n">multiviewAlgos</span>
        <span class="k">for</span> <span class="n">multiviewPackageName</span> <span class="ow">in</span> <span class="n">allMultiviewPackages</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">multiviewPackageName</span> <span class="ow">in</span> <span class="n">algosMutliview</span><span class="p">:</span>
                <span class="n">multiviewPackage</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">MultiviewClassifiers</span><span class="p">,</span> <span class="n">multiviewPackageName</span><span class="p">)</span>
                <span class="n">multiviewModule</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">multiviewPackage</span><span class="p">,</span> <span class="n">multiviewPackageName</span><span class="o">+</span><span class="s2">&quot;Module&quot;</span><span class="p">)</span>
                <span class="n">benchmark</span> <span class="o">=</span> <span class="n">multiviewModule</span><span class="o">.</span><span class="n">getBenchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">CL_type</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;Benchmark&quot;</span><span class="p">]:</span>
        <span class="n">allMonoviewAlgos</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">isPackage</span> <span class="ow">in</span>
                            <span class="n">pkgutil</span><span class="o">.</span><span class="n">iter_modules</span><span class="p">([</span><span class="s1">&#39;./MonoMultiViewClassifiers/MonoviewClassifiers&#39;</span><span class="p">])</span>
                            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">isPackage</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;framework&quot;</span><span class="p">]]</span>
        <span class="n">benchmark</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allMonoviewAlgos</span>
        <span class="n">benchmark</span><span class="p">[</span><span class="s2">&quot;Multiview&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">multiviewPackageName</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">multiviewPackageName</span> <span class="ow">in</span> <span class="n">allMultiviewPackages</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">multiviewPackageName</span> <span class="ow">in</span> <span class="n">allMultiviewPackages</span><span class="p">:</span>
            <span class="n">multiviewPackage</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">MultiviewClassifiers</span><span class="p">,</span> <span class="n">multiviewPackageName</span><span class="p">)</span>
            <span class="n">multiviewModule</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">multiviewPackage</span><span class="p">,</span> <span class="n">multiviewPackageName</span><span class="o">+</span><span class="s2">&quot;Module&quot;</span><span class="p">)</span>
            <span class="n">benchmark</span> <span class="o">=</span> <span class="n">multiviewModule</span><span class="o">.</span><span class="n">getBenchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">benchmark</span></div>


<div class="viewcode-block" id="genViewsDictionnary"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.genViewsDictionnary">[docs]</a><span class="k">def</span> <span class="nf">genViewsDictionnary</span><span class="p">(</span><span class="n">DATASET</span><span class="p">,</span> <span class="n">views</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Used to generate a dictionary mapping a view name (key) to it&#39;s index in the dataset (value).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    DATASET : `h5py` dataset file</span>
<span class="sd">        The full dataset on which the benchmark will be done</span>
<span class="sd">    views : List of strings</span>
<span class="sd">        Names of the selected views on which the banchmark will be done</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    viewDictionary : Dictionary</span>
<span class="sd">        Dictionary mapping the view names totheir indexin the full dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">datasetsNames</span> <span class="o">=</span> <span class="n">DATASET</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">viewsDictionary</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">datasetName</span> <span class="ow">in</span> <span class="n">datasetsNames</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">datasetName</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;View&quot;</span><span class="p">:</span>
            <span class="n">viewName</span> <span class="o">=</span> <span class="n">DATASET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">datasetName</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">viewName</span><span class="p">)</span><span class="o">==</span><span class="nb">bytes</span><span class="p">:</span>
                <span class="n">viewName</span> <span class="o">=</span> <span class="n">viewName</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">viewName</span> <span class="ow">in</span> <span class="n">views</span><span class="p">:</span>
                <span class="n">viewsDictionary</span><span class="p">[</span><span class="n">viewName</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">datasetName</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span>

    <span class="k">return</span> <span class="n">viewsDictionary</span></div>


<div class="viewcode-block" id="initMonoviewExps"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.initMonoviewExps">[docs]</a><span class="k">def</span> <span class="nf">initMonoviewExps</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">viewsDictionary</span><span class="p">,</span> <span class="n">nbClass</span><span class="p">,</span> <span class="n">kwargsInit</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Used to add each monoview exeperience args to the list of monoview experiences args.</span>

<span class="sd">    First this function will check if the benchmark need mono- or/and multiview algorithms and adds to the right</span>
<span class="sd">    dictionary the asked algorithms. If none is asked by the user, all will be added.</span>

<span class="sd">    If the keyword `&quot;Benchmark&quot;` is used, all mono- and multiview algorithms will be added.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    benchmark : dictionary</span>
<span class="sd">        All types of monoview and multiview experiments that have to be benchmarked</span>
<span class="sd">    argumentDictionaries : dictionary</span>
<span class="sd">        Maps monoview and multiview experiments arguments.</span>
<span class="sd">    viewDictionary : dictionary</span>
<span class="sd">        Maps the view names to their index in the HDF5 dataset</span>
<span class="sd">    nbClass : integer</span>
<span class="sd">        Number of different labels in the classification</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    benchmark : Dictionary of dictionaries</span>
<span class="sd">        Dictionary resuming which mono- and multiview algorithms which will be used in the benchmark.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">argumentDictionaries</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Monoview&quot;</span><span class="p">:[],</span> <span class="s2">&quot;Multiview&quot;</span><span class="p">:[]}</span>
    <span class="k">if</span> <span class="n">benchmark</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">]:</span>
        <span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">viewName</span><span class="p">,</span> <span class="n">viewIndex</span> <span class="ow">in</span> <span class="n">viewsDictionary</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">classifier</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">]:</span>
                <span class="n">arguments</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">classifier</span> <span class="o">+</span> <span class="s2">&quot;KWARGS&quot;</span><span class="p">:</span> <span class="n">kwargsInit</span><span class="p">[</span><span class="n">classifier</span> <span class="o">+</span> <span class="s2">&quot;KWARGSInit&quot;</span><span class="p">],</span> <span class="s2">&quot;feat&quot;</span><span class="p">:</span> <span class="n">viewName</span><span class="p">,</span>
                             <span class="s2">&quot;CL_type&quot;</span><span class="p">:</span> <span class="n">classifier</span><span class="p">,</span> <span class="s2">&quot;nbClass&quot;</span><span class="p">:</span> <span class="n">nbClass</span><span class="p">},</span> <span class="s2">&quot;viewIndex&quot;</span><span class="p">:</span> <span class="n">viewIndex</span><span class="p">}</span>
                <span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">argumentDictionaries</span></div>


<div class="viewcode-block" id="initMonoviewKWARGS"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.initMonoviewKWARGS">[docs]</a><span class="k">def</span> <span class="nf">initMonoviewKWARGS</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">classifiersNames</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Used to init kwargs thanks to a function in each monoview classifier package.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    args : parsed args objects</span>
<span class="sd">        All the args passed by the user.</span>
<span class="sd">    classifiersNames : list of strings</span>
<span class="sd">        List of the benchmarks&#39;s monoview classifiers names.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    monoviewKWARGS : Dictionary of dictionaries</span>
<span class="sd">        Dictionary resuming all the specific arguments for the benchmark, one dictionary for each classifier.</span>

<span class="sd">        For example, for Adaboost, the KWARGS will be `{&quot;n_estimators&quot;:&lt;value&gt;, &quot;base_estimator&quot;:&lt;value&gt;}`&quot;&quot;&quot;</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Initializing Monoview classifiers arguments&quot;</span><span class="p">)</span>
    <span class="n">monoviewKWARGS</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">classifiersName</span> <span class="ow">in</span> <span class="n">classifiersNames</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">classifierModule</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">MonoviewClassifiers</span><span class="p">,</span> <span class="n">classifiersName</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">classifiersName</span><span class="o">+</span><span class="s2">&quot; is not implemented in MonoviewClassifiers, &quot;</span>
                                                 <span class="s2">&quot;please specify the name of the file in MonoviewClassifiers&quot;</span><span class="p">)</span>
        <span class="n">monoviewKWARGS</span><span class="p">[</span><span class="n">classifiersName</span> <span class="o">+</span> <span class="s2">&quot;KWARGSInit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">classifierModule</span><span class="o">.</span><span class="n">formatCmdArgs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Initializing Monoview classifiers arguments&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">monoviewKWARGS</span></div>


<span class="k">def</span> <span class="nf">initKWARGSFunc</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">):</span>
    <span class="n">monoviewKWARGS</span> <span class="o">=</span> <span class="n">initMonoviewKWARGS</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">monoviewKWARGS</span>


<div class="viewcode-block" id="initMultiviewArguments"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.initMultiviewArguments">[docs]</a><span class="k">def</span> <span class="nf">initMultiviewArguments</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">views</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="p">,</span> <span class="n">argumentDictionaries</span><span class="p">,</span> <span class="n">randomState</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span>
                           <span class="n">resultsMonoview</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Used to add each monoview exeperience args to the list of monoview experiences args&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Initializing Multiview classifiers arguments&quot;</span><span class="p">)</span>
    <span class="n">multiviewArguments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="s2">&quot;Multiview&quot;</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">multiviewAlgoName</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="p">[</span><span class="s2">&quot;Multiview&quot;</span><span class="p">]:</span>
            <span class="n">multiviewPackage</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">MultiviewClassifiers</span><span class="p">,</span> <span class="n">multiviewAlgoName</span><span class="p">)</span>
            <span class="n">mutliviewModule</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">multiviewPackage</span><span class="p">,</span> <span class="n">multiviewAlgoName</span><span class="o">+</span><span class="s2">&quot;Module&quot;</span><span class="p">)</span>

            <span class="n">multiviewArguments</span> <span class="o">+=</span> <span class="n">mutliviewModule</span><span class="o">.</span><span class="n">getArgs</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">views</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="p">,</span> <span class="n">randomState</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span>
                                                          <span class="n">resultsMonoview</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">)</span>
    <span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Multiview&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiviewArguments</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Initializing Multiview classifiers arguments&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">argumentDictionaries</span></div>


<div class="viewcode-block" id="arangeMetrics"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.arangeMetrics">[docs]</a><span class="k">def</span> <span class="nf">arangeMetrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">metricPrinc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Used to get the metrics list in the right order so that</span>
<span class="sd">    the first one is the principal metric specified in args&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">[</span><span class="n">metricPrinc</span><span class="p">]</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
        <span class="n">metricIndex</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="n">metricPrinc</span><span class="p">])</span>
        <span class="n">firstMetric</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">metricPrinc</span><span class="p">]</span>
        <span class="n">metrics</span><span class="p">[</span><span class="n">metricIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">firstMetric</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">metricPrinc</span> <span class="o">+</span> <span class="s2">&quot; not in metric pool&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">metrics</span></div>


<span class="k">def</span> <span class="nf">benchmarkInit</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">):</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Benchmark initialization&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;train_labels.csv&quot;</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;train_labels.csv&quot;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="n">errno</span><span class="o">.</span><span class="n">EEXIST</span><span class="p">:</span>
                <span class="k">raise</span>
    <span class="n">trainIndices</span> <span class="o">=</span> <span class="n">classificationIndices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">trainLabels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">trainIndices</span><span class="p">]</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;train_labels.csv&quot;</span><span class="p">,</span> <span class="n">trainLabels</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;train_indices.csv&quot;</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">resultsMonoview</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">folds</span> <span class="o">=</span> <span class="n">kFolds</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trainLabels</span><span class="p">)),</span> <span class="n">trainLabels</span><span class="p">)</span>
    <span class="n">minFoldLen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trainLabels</span><span class="p">)</span><span class="o">/</span><span class="n">kFolds</span><span class="o">.</span><span class="n">n_splits</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">foldIndex</span><span class="p">,</span> <span class="p">(</span><span class="n">trainCVIndices</span><span class="p">,</span> <span class="n">testCVIndices</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">):</span>
        <span class="n">fileName</span> <span class="o">=</span> <span class="n">directory</span><span class="o">+</span><span class="s2">&quot;/folds/test_labels_fold_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">foldIndex</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.csv&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fileName</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fileName</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="n">errno</span><span class="o">.</span><span class="n">EEXIST</span><span class="p">:</span>
                    <span class="k">raise</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">trainLabels</span><span class="p">[</span><span class="n">testCVIndices</span><span class="p">[:</span><span class="n">minFoldLen</span><span class="p">]],</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">labelsNames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">LABELS_DICTIONARY</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Benchmark initialization&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resultsMonoview</span><span class="p">,</span> <span class="n">labelsNames</span>


<div class="viewcode-block" id="execOneBenchmark"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.execOneBenchmark">[docs]</a><span class="k">def</span> <span class="nf">execOneBenchmark</span><span class="p">(</span><span class="n">coreIndex</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">kFolds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">randomState</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hyperParamSearch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">argumentDictionaries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">benchmark</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">views</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">ExecMonoview_multicore</span><span class="o">=</span><span class="n">ExecMonoview_multicore</span><span class="p">,</span> <span class="n">ExecMultiview_multicore</span><span class="o">=</span><span class="n">ExecMultiview_multicore</span><span class="p">,</span>
                     <span class="n">initMultiviewArguments</span><span class="o">=</span><span class="n">initMultiviewArguments</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Used to run a benchmark using one core. ExecMonoview_multicore, initMultiviewArguments and</span>
<span class="sd">     ExecMultiview_multicore args are only used for tests&quot;&quot;&quot;</span>

    <span class="n">resultsMonoview</span><span class="p">,</span> <span class="n">labelsNames</span> <span class="o">=</span> <span class="n">benchmarkInit</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Monoview benchmark&quot;</span><span class="p">)</span>
    <span class="n">resultsMonoview</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ExecMonoview_multicore</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">labelsNames</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">,</span>
                                               <span class="n">coreIndex</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">pathF</span><span class="p">,</span> <span class="n">randomState</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                                               <span class="n">hyperParamSearch</span><span class="o">=</span><span class="n">hyperParamSearch</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
                                               <span class="n">nIter</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">CL_HPS_iter</span><span class="p">,</span> <span class="o">**</span><span class="n">argument</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">]]</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Monoview benchmark&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Multiview arguments initialization&quot;</span><span class="p">)</span>
    <span class="n">argumentDictionaries</span> <span class="o">=</span> <span class="n">initMultiviewArguments</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">views</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="p">,</span> <span class="n">argumentDictionaries</span><span class="p">,</span>
                                                  <span class="n">randomState</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">resultsMonoview</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Multiview arguments initialization&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Multiview benchmark&quot;</span><span class="p">)</span>
    <span class="n">resultsMultiview</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">ExecMultiview_multicore</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">coreIndex</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
                                <span class="n">args</span><span class="o">.</span><span class="n">pathF</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="p">,</span> <span class="n">randomState</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">hyperParamSearch</span><span class="o">=</span><span class="n">hyperParamSearch</span><span class="p">,</span>
                                <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span> <span class="n">nIter</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">CL_HPS_iter</span><span class="p">,</span> <span class="o">**</span><span class="n">arguments</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">arguments</span> <span class="ow">in</span> <span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Multiview&quot;</span><span class="p">]]</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Multiview benchmark&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">flag</span><span class="p">,</span> <span class="n">resultsMonoview</span> <span class="o">+</span> <span class="n">resultsMultiview</span><span class="p">]</span></div>


<div class="viewcode-block" id="execOneBenchmark_multicore"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.execOneBenchmark_multicore">[docs]</a><span class="k">def</span> <span class="nf">execOneBenchmark_multicore</span><span class="p">(</span><span class="n">nbCores</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">kFolds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">randomState</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hyperParamSearch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">argumentDictionaries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">benchmark</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">views</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">ExecMonoview_multicore</span><span class="o">=</span><span class="n">ExecMonoview_multicore</span><span class="p">,</span>
                               <span class="n">ExecMultiview_multicore</span><span class="o">=</span><span class="n">ExecMultiview_multicore</span><span class="p">,</span>
                               <span class="n">initMultiviewArguments</span><span class="o">=</span><span class="n">initMultiviewArguments</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Used to run a benchmark using multiple cores. ExecMonoview_multicore, initMultiviewArguments and</span>
<span class="sd">     ExecMultiview_multicore args are only used for tests&quot;&quot;&quot;</span>

    <span class="n">resultsMonoview</span><span class="p">,</span> <span class="n">labelsNames</span> <span class="o">=</span> <span class="n">benchmarkInit</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Monoview benchmark&quot;</span><span class="p">)</span>
    <span class="n">nbExperiments</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">])</span>
    <span class="n">nbMulticoreToDo</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nbExperiments</span><span class="p">)</span> <span class="o">/</span> <span class="n">nbCores</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">stepIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbMulticoreToDo</span><span class="p">):</span>
        <span class="n">resultsMonoview</span> <span class="o">+=</span> <span class="p">(</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">nbCores</span><span class="p">)(</span>
            <span class="n">delayed</span><span class="p">(</span><span class="n">ExecMonoview_multicore</span><span class="p">)(</span><span class="n">directory</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">labelsNames</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">,</span>
                                            <span class="n">coreIndex</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">pathF</span><span class="p">,</span> <span class="n">randomState</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                                            <span class="n">hyperParamSearch</span><span class="o">=</span><span class="n">hyperParamSearch</span><span class="p">,</span>
                                            <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span> <span class="n">nIter</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">CL_HPS_iter</span><span class="p">,</span>
                                            <span class="o">**</span><span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">][</span><span class="n">coreIndex</span> <span class="o">+</span> <span class="n">stepIndex</span> <span class="o">*</span> <span class="n">nbCores</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">coreIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">nbCores</span><span class="p">,</span> <span class="n">nbExperiments</span> <span class="o">-</span> <span class="n">stepIndex</span> <span class="o">*</span> <span class="n">nbCores</span><span class="p">))))</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Monoview benchmark&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Multiview arguments initialization&quot;</span><span class="p">)</span>
    <span class="n">argumentDictionaries</span> <span class="o">=</span> <span class="n">initMultiviewArguments</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">views</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="p">,</span> <span class="n">argumentDictionaries</span><span class="p">,</span>
                                                  <span class="n">randomState</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">resultsMonoview</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Multiview arguments initialization&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Multiview benchmark&quot;</span><span class="p">)</span>
    <span class="n">resultsMultiview</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nbExperiments</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Multiview&quot;</span><span class="p">])</span>
    <span class="n">nbMulticoreToDo</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nbExperiments</span><span class="p">)</span> <span class="o">/</span> <span class="n">nbCores</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">stepIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbMulticoreToDo</span><span class="p">):</span>
        <span class="n">resultsMultiview</span> <span class="o">+=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">nbCores</span><span class="p">)(</span>
            <span class="n">delayed</span><span class="p">(</span><span class="n">ExecMultiview_multicore</span><span class="p">)(</span><span class="n">directory</span><span class="p">,</span> <span class="n">coreIndex</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">,</span>
                                             <span class="n">args</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">pathF</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="p">,</span> <span class="n">randomState</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                                             <span class="n">hyperParamSearch</span><span class="o">=</span><span class="n">hyperParamSearch</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span> <span class="n">nIter</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">CL_HPS_iter</span><span class="p">,</span>
                                             <span class="o">**</span><span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Multiview&quot;</span><span class="p">][</span><span class="n">stepIndex</span> <span class="o">*</span> <span class="n">nbCores</span> <span class="o">+</span> <span class="n">coreIndex</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">coreIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">nbCores</span><span class="p">,</span> <span class="n">nbExperiments</span> <span class="o">-</span> <span class="n">stepIndex</span> <span class="o">*</span> <span class="n">nbCores</span><span class="p">)))</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Multiview benchmark&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">flag</span><span class="p">,</span> <span class="n">resultsMonoview</span> <span class="o">+</span> <span class="n">resultsMultiview</span><span class="p">]</span></div>


<span class="k">def</span> <span class="nf">execOneBenchmarkMonoCore</span><span class="p">(</span><span class="n">DATASET</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">kFolds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">randomState</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hyperParamSearch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">argumentDictionaries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">benchmark</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">views</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">ExecMonoview_multicore</span><span class="o">=</span><span class="n">ExecMonoview_multicore</span><span class="p">,</span> <span class="n">ExecMultiview_multicore</span><span class="o">=</span><span class="n">ExecMultiview_multicore</span><span class="p">,</span>
                             <span class="n">initMultiviewArguments</span><span class="o">=</span><span class="n">initMultiviewArguments</span><span class="p">):</span>

    <span class="n">resultsMonoview</span><span class="p">,</span> <span class="n">labelsNames</span> <span class="o">=</span> <span class="n">benchmarkInit</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Monoview benchmark&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">arguments</span> <span class="ow">in</span> <span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Monoview&quot;</span><span class="p">]:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">DATASET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;View&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="s2">&quot;viewIndex&quot;</span><span class="p">]))</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="n">resultsMonoview</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ExecMonoview</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">labelsNames</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">,</span>
                                                   <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">pathF</span><span class="p">,</span> <span class="n">randomState</span><span class="p">,</span>
                                                   <span class="n">hyperParamSearch</span><span class="o">=</span><span class="n">hyperParamSearch</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
                                                   <span class="n">nIter</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">CL_HPS_iter</span><span class="p">,</span> <span class="o">**</span><span class="n">arguments</span><span class="p">)]</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Monoview benchmark&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Multiview arguments initialization&quot;</span><span class="p">)</span>

    <span class="n">argumentDictionaries</span> <span class="o">=</span> <span class="n">initMultiviewArguments</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">views</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="p">,</span> <span class="n">argumentDictionaries</span><span class="p">,</span>
                                                  <span class="n">randomState</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">resultsMonoview</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Multiview arguments initialization&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Multiview benchmark&quot;</span><span class="p">)</span>
    <span class="n">resultsMultiview</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">arguments</span> <span class="ow">in</span> <span class="n">argumentDictionaries</span><span class="p">[</span><span class="s2">&quot;Multiview&quot;</span><span class="p">]:</span>
        <span class="n">resultsMultiview</span> <span class="o">+=</span> <span class="p">[</span>
            <span class="n">ExecMultiview</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">DATASET</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
                                    <span class="n">args</span><span class="o">.</span><span class="n">pathF</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="p">,</span> <span class="n">randomState</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">hyperParamSearch</span><span class="o">=</span><span class="n">hyperParamSearch</span><span class="p">,</span>
                                    <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span> <span class="n">nIter</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">CL_HPS_iter</span><span class="p">,</span> <span class="o">**</span><span class="n">arguments</span><span class="p">)]</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Multiview benchmark&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">flag</span><span class="p">,</span> <span class="n">resultsMonoview</span> <span class="o">+</span> <span class="n">resultsMultiview</span><span class="p">]</span>


<div class="viewcode-block" id="execBenchmark"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.execBenchmark">[docs]</a><span class="k">def</span> <span class="nf">execBenchmark</span><span class="p">(</span><span class="n">nbCores</span><span class="p">,</span> <span class="n">statsIter</span><span class="p">,</span> <span class="n">nbMulticlass</span><span class="p">,</span> <span class="n">benchmarkArgumentsDictionaries</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span>
                  <span class="n">directory</span><span class="p">,</span> <span class="n">multiClassLabels</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">labelsDictionary</span><span class="p">,</span> <span class="n">nbLabels</span><span class="p">,</span> <span class="n">DATASET</span><span class="p">,</span>
                  <span class="n">execOneBenchmark</span><span class="o">=</span><span class="n">execOneBenchmark</span><span class="p">,</span> <span class="n">execOneBenchmark_multicore</span><span class="o">=</span><span class="n">execOneBenchmark_multicore</span><span class="p">,</span>
                  <span class="n">execOneBenchmarkMonoCore</span><span class="o">=</span><span class="n">execOneBenchmarkMonoCore</span><span class="p">,</span> <span class="n">getResults</span><span class="o">=</span><span class="n">getResults</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="n">DB</span><span class="o">.</span><span class="n">deleteHDF5</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Used to execute the needed benchmark(s) on multicore or mono-core functions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nbCores : int</span>
<span class="sd">        Number of threads that the benchmarks can use.</span>
<span class="sd">    statsIter : int</span>
<span class="sd">        Number of statistical iterations that have to be done.</span>
<span class="sd">    benchmarkArgumentsDictionaries : list of dictionaries</span>
<span class="sd">        All the needed arguments for the benchmarks.</span>
<span class="sd">    classificationIndices : list of lists of numpy.ndarray</span>
<span class="sd">        For each statistical iteration a couple of numpy.ndarrays is stored with the indices for the training set and</span>
<span class="sd">        the ones of the testing set.</span>
<span class="sd">    directories : list of strings</span>
<span class="sd">        List of the paths to the result directories for each statistical iteration.</span>
<span class="sd">    directory : string</span>
<span class="sd">        Path to the main results directory.</span>
<span class="sd">    multiClassLabels : ist of lists of numpy.ndarray</span>
<span class="sd">        For each label couple, for each statistical iteration a triplet of numpy.ndarrays is stored with the</span>
<span class="sd">        indices for the biclass training set, the ones for the biclass testing set and the ones for the</span>
<span class="sd">        multiclass testing set.</span>
<span class="sd">    metrics : list of lists</span>
<span class="sd">        Metrics that will be used to evaluate the algorithms performance.</span>
<span class="sd">    labelsDictionary : dictionary</span>
<span class="sd">        Dictionary mapping labels indices to labels names.</span>
<span class="sd">    nbLabels : int</span>
<span class="sd">        Total number of different labels in the dataset.</span>
<span class="sd">    DATASET : HDF5 dataset file</span>
<span class="sd">        The full dataset that wil be used by the benchmark.</span>
<span class="sd">    classifiersNames : list of strings</span>
<span class="sd">        List of the benchmarks&#39;s monoview classifiers names.</span>
<span class="sd">    rest_of_the_args :</span>
<span class="sd">        Just used for testing purposes</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : list of lists</span>
<span class="sd">        The results of the benchmark.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Executing all the needed biclass benchmarks&quot;</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">nbCores</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">statsIter</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">nbMulticlass</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">nbExpsToDo</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">benchmarkArgumentsDictionaries</span><span class="p">)</span>
            <span class="n">nbMulticoreToDo</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nbExpsToDo</span><span class="p">)</span> <span class="o">/</span> <span class="n">nbCores</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">stepIndex</span> <span class="ow">in</span> <span class="n">nbMulticoreToDo</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">+=</span> <span class="p">(</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">nbCores</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">execOneBenchmark</span><span class="p">)</span>
                                                     <span class="p">(</span><span class="n">coreIndex</span><span class="o">=</span><span class="n">coreIndex</span><span class="p">,</span>
                                                      <span class="o">**</span><span class="n">benchmarkArgumentsDictionaries</span><span class="p">[</span><span class="n">coreIndex</span> <span class="o">+</span> <span class="n">stepIndex</span> <span class="o">*</span> <span class="n">nbCores</span><span class="p">])</span>
                                                     <span class="k">for</span> <span class="n">coreIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">nbCores</span><span class="p">,</span> <span class="n">nbExpsToDo</span> <span class="o">-</span> <span class="n">stepIndex</span> <span class="o">*</span> <span class="n">nbCores</span><span class="p">))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">+=</span> <span class="p">[</span><span class="n">execOneBenchmark_multicore</span><span class="p">(</span><span class="n">nbCores</span><span class="o">=</span><span class="n">nbCores</span><span class="p">,</span> <span class="o">**</span><span class="n">benchmarkArgumentsDictionaries</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">arguments</span> <span class="ow">in</span> <span class="n">benchmarkArgumentsDictionaries</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">+=</span> <span class="p">[</span><span class="n">execOneBenchmarkMonoCore</span><span class="p">(</span><span class="n">DATASET</span><span class="o">=</span><span class="n">DATASET</span><span class="p">,</span> <span class="o">**</span><span class="n">arguments</span><span class="p">)]</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Executing all the needed biclass benchmarks&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nbCores</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Deleting &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nbCores</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; temporary datasets for multiprocessing&quot;</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">benchmarkArgumentsDictionaries</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
        <span class="n">datasetFiles</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">pathF</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">nbCores</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Deleting datasets for multiprocessing&quot;</span><span class="p">)</span>
    <span class="c1"># Do everything with flagging</span>
    <span class="n">nbExamples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">classificationIndices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">classificationIndices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">multiclassGroundTruth</span> <span class="o">=</span> <span class="n">DATASET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Labels&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start:</span><span class="se">\t</span><span class="s2"> Analyzing predictions&quot;</span><span class="p">)</span>
    <span class="n">getResults</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">statsIter</span><span class="p">,</span> <span class="n">nbMulticlass</span><span class="p">,</span> <span class="n">benchmarkArgumentsDictionaries</span><span class="p">,</span> <span class="n">multiclassGroundTruth</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">classificationIndices</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">labelsDictionary</span><span class="p">,</span> <span class="n">nbExamples</span><span class="p">,</span> <span class="n">nbLabels</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Done:</span><span class="se">\t</span><span class="s2"> Analyzing predictions&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span></div>


<div class="viewcode-block" id="execClassif"><a class="viewcode-back" href="../../../monomulti/exec_classif.html#multiview_platform.MonoMultiViewClassifiers.ExecClassif.execClassif">[docs]</a><span class="k">def</span> <span class="nf">execClassif</span><span class="p">(</span><span class="n">arguments</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Main function to execute the benchmark&quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">parseTheArgs</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">nice</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">nice</span><span class="p">)</span>
    <span class="n">nbCores</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">nbCores</span>
    <span class="n">statsIter</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_statsiter</span>
    <span class="n">hyperParamSearch</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_HPS_type</span>
    <span class="n">multiclassMethod</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_multiclassMethod</span>
    <span class="n">CL_type</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_type</span>
    <span class="n">monoviewAlgos</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_algos_monoview</span>
    <span class="n">multiviewAlgos</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_algos_multiview</span>

    <span class="n">directory</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">initLogFile</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">views</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">debug</span><span class="p">)</span>
    <span class="n">randomState</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">initRandomState</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">randomState</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>
    <span class="n">statsIterRandomStates</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">initStatsIterRandomStates</span><span class="p">(</span><span class="n">statsIter</span><span class="p">,</span><span class="n">randomState</span><span class="p">)</span>

    <span class="n">getDatabase</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">getDatabaseFunction</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">args</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

    <span class="n">DATASET</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span> <span class="o">=</span> <span class="n">getDatabase</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">views</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">pathF</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_nbClass</span><span class="p">,</span>
                                             <span class="n">args</span><span class="o">.</span><span class="n">CL_classes</span><span class="p">,</span> <span class="n">randomState</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">full</span><span class="p">)</span>

    <span class="n">splits</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">genSplits</span><span class="p">(</span><span class="n">DATASET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Labels&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_split</span><span class="p">,</span> <span class="n">statsIterRandomStates</span><span class="p">)</span>

    <span class="n">multiclassLabels</span><span class="p">,</span> <span class="n">labelsCombinations</span><span class="p">,</span> <span class="n">indicesMulticlass</span> <span class="o">=</span> <span class="n">Multiclass</span><span class="o">.</span><span class="n">genMulticlassLabels</span><span class="p">(</span><span class="n">DATASET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Labels&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">multiclassMethod</span><span class="p">,</span> <span class="n">splits</span><span class="p">)</span>

    <span class="n">kFolds</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">genKFolds</span><span class="p">(</span><span class="n">statsIter</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_nbFolds</span><span class="p">,</span> <span class="n">statsIterRandomStates</span><span class="p">)</span>

    <span class="n">datasetFiles</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">initMultipleDatasets</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">pathF</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">nbCores</span><span class="p">)</span>

    <span class="c1"># if not views:</span>
    <span class="c1">#     raise ValueError(&quot;Empty views list, modify selected views to match dataset &quot; + args.views)</span>

    <span class="n">views</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="p">,</span> <span class="n">allViews</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">initViews</span><span class="p">(</span><span class="n">DATASET</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
    <span class="n">viewsDictionary</span> <span class="o">=</span> <span class="n">genViewsDictionnary</span><span class="p">(</span><span class="n">DATASET</span><span class="p">,</span> <span class="n">views</span><span class="p">)</span>
    <span class="n">nbViews</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">views</span><span class="p">)</span>
    <span class="n">NB_CLASS</span> <span class="o">=</span> <span class="n">DATASET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Metadata&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;nbClass&quot;</span><span class="p">]</span>

    <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">metric</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_metrics</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">metrics</span> <span class="o">==</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">]]:</span>
        <span class="n">metricsNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">isPackage</span>
                        <span class="ow">in</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">iter_modules</span><span class="p">([</span><span class="s1">&#39;./MonoMultiViewClassifiers/Metrics&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">isPackage</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;framework&quot;</span><span class="p">,</span> <span class="s2">&quot;log_loss&quot;</span><span class="p">,</span> <span class="s2">&quot;matthews_corrcoef&quot;</span><span class="p">,</span> <span class="s2">&quot;roc_auc_score&quot;</span><span class="p">]]</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[[</span><span class="n">metricName</span><span class="p">]</span> <span class="k">for</span> <span class="n">metricName</span> <span class="ow">in</span> <span class="n">metricsNames</span><span class="p">]</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">arangeMetrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">CL_metric_princ</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">metricIndex</span><span class="p">,</span> <span class="n">metric</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">metrics</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">metrics</span><span class="p">[</span><span class="n">metricIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">metric</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span>

    <span class="n">benchmark</span> <span class="o">=</span> <span class="n">initBenchmark</span><span class="p">(</span><span class="n">CL_type</span><span class="p">,</span> <span class="n">monoviewAlgos</span><span class="p">,</span> <span class="n">multiviewAlgos</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="n">initKWARGS</span> <span class="o">=</span> <span class="n">initKWARGSFunc</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">)</span>

    <span class="n">dataBaseTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="n">argumentDictionaries</span> <span class="o">=</span> <span class="n">initMonoviewExps</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">viewsDictionary</span><span class="p">,</span> <span class="n">NB_CLASS</span><span class="p">,</span> <span class="n">initKWARGS</span><span class="p">)</span>
    <span class="n">directories</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">genDirecortiesNames</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">statsIter</span><span class="p">)</span>
    <span class="n">benchmarkArgumentDictionaries</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">genArgumentDictionaries</span><span class="p">(</span><span class="n">LABELS_DICTIONARY</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">multiclassLabels</span><span class="p">,</span>
                                                                      <span class="n">labelsCombinations</span><span class="p">,</span> <span class="n">indicesMulticlass</span><span class="p">,</span>
                                                                      <span class="n">hyperParamSearch</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kFolds</span><span class="p">,</span>
                                                                      <span class="n">statsIterRandomStates</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span>
                                                                      <span class="n">argumentDictionaries</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">nbViews</span><span class="p">,</span>
                                                                      <span class="n">views</span><span class="p">,</span> <span class="n">viewsIndices</span><span class="p">)</span>
    <span class="n">nbMulticlass</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labelsCombinations</span><span class="p">)</span>

    <span class="n">execBenchmark</span><span class="p">(</span><span class="n">nbCores</span><span class="p">,</span> <span class="n">statsIter</span><span class="p">,</span> <span class="n">nbMulticlass</span><span class="p">,</span> <span class="n">benchmarkArgumentDictionaries</span><span class="p">,</span> <span class="n">splits</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span>
                  <span class="n">directory</span><span class="p">,</span> <span class="n">multiclassLabels</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">LABELS_DICTIONARY</span><span class="p">,</span> <span class="n">NB_CLASS</span><span class="p">,</span> <span class="n">DATASET</span><span class="p">)</span></div>











    <span class="c1">#</span>
<span class="c1"># def classifyOneIter_multicore(LABELS_DICTIONARY, argumentDictionaries, nbCores, directory, args, classificationIndices,</span>
<span class="c1">#                               kFolds,</span>
<span class="c1">#                               randomState, hyperParamSearch, metrics, coreIndex, viewsIndices, dataBaseTime, start,</span>
<span class="c1">#                               benchmark,</span>
<span class="c1">#                               views):</span>
<span class="c1">#     &quot;&quot;&quot;Used to execute mono and multiview classification and result analysis for one random state</span>
<span class="c1">#      using multicore classification&quot;&quot;&quot;</span>
<span class="c1">#     resultsMonoview = []</span>
<span class="c1">#     labelsNames = LABELS_DICTIONARY.values()</span>
<span class="c1">#     np.savetxt(directory + &quot;train_indices.csv&quot;, classificationIndices[0], delimiter=&quot;,&quot;)</span>
<span class="c1">#</span>
<span class="c1">#     resultsMonoview += [ExecMonoview_multicore(directory, args.name, labelsNames, classificationIndices, kFolds,</span>
<span class="c1">#                                                coreIndex, args.type, args.pathF, randomState,</span>
<span class="c1">#                                                hyperParamSearch=hyperParamSearch,</span>
<span class="c1">#                                                metrics=metrics, nIter=args.CL_HPS_iter,</span>
<span class="c1">#                                                **arguments)</span>
<span class="c1">#                         for arguments in argumentDictionaries[&quot;Monoview&quot;]]</span>
<span class="c1">#     monoviewTime = time.time() - dataBaseTime - start</span>
<span class="c1">#</span>
<span class="c1">#     argumentDictionaries = initMultiviewArguments(args, benchmark, views, viewsIndices, argumentDictionaries,</span>
<span class="c1">#                                                   randomState, directory, resultsMonoview, classificationIndices)</span>
<span class="c1">#</span>
<span class="c1">#     resultsMultiview = []</span>
<span class="c1">#     resultsMultiview += [</span>
<span class="c1">#         ExecMultiview_multicore(directory, coreIndex, args.name, classificationIndices, kFolds, args.type,</span>
<span class="c1">#                                 args.pathF, LABELS_DICTIONARY, randomState, hyperParamSearch=hyperParamSearch,</span>
<span class="c1">#                                 metrics=metrics, nIter=args.CL_HPS_iter, **arguments)</span>
<span class="c1">#         for arguments in argumentDictionaries[&quot;Multiview&quot;]]</span>
<span class="c1">#     multiviewTime = time.time() - monoviewTime - dataBaseTime - start</span>
<span class="c1">#</span>
<span class="c1">#     labels = np.array(</span>
<span class="c1">#         [resultMonoview[1][3] for resultMonoview in resultsMonoview] + [resultMultiview[3] for resultMultiview in</span>
<span class="c1">#                                                                         resultsMultiview]).transpose()</span>
<span class="c1">#     DATASET = h5py.File(args.pathF + args.name + str(0) + &quot;.hdf5&quot;, &quot;r&quot;)</span>
<span class="c1">#     trueLabels = DATASET.get(&quot;Labels&quot;).value</span>
<span class="c1">#     times = [dataBaseTime, monoviewTime, multiviewTime]</span>
<span class="c1">#     results = (resultsMonoview, resultsMultiview)</span>
<span class="c1">#     labelAnalysis = analyzeLabels(labels, trueLabels, results, directory)</span>
<span class="c1">#     logging.debug(&quot;Start:\t Analyze Iteration Results&quot;)</span>
<span class="c1">#     resultAnalysis(benchmark, results, args.name, times, metrics, directory)</span>
<span class="c1">#     logging.debug(&quot;Done:\t Analyze Iteration Results&quot;)</span>
<span class="c1">#     globalAnalysisTime = time.time() - monoviewTime - dataBaseTime - start - multiviewTime</span>
<span class="c1">#     totalTime = time.time() - start</span>
<span class="c1">#     logging.info(&quot;Extraction time : &quot; + str(int(dataBaseTime)) +</span>
<span class="c1">#                  &quot;s, Monoview time : &quot; + str(int(monoviewTime)) +</span>
<span class="c1">#                  &quot;s, Multiview Time : &quot; + str(int(multiviewTime)) +</span>
<span class="c1">#                  &quot;s, Iteration Analysis Time : &quot; + str(int(globalAnalysisTime)) +</span>
<span class="c1">#                  &quot;s, Iteration Duration : &quot; + str(int(totalTime)) + &quot;s&quot;)</span>
<span class="c1">#     return results, labelAnalysis</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># def classifyOneIter(LABELS_DICTIONARY, argumentDictionaries, nbCores, directory, args, classificationIndices, kFolds,</span>
<span class="c1">#                     randomState, hyperParamSearch, metrics, DATASET, viewsIndices, dataBaseTime, start,</span>
<span class="c1">#                     benchmark, views):</span>
<span class="c1">#     &quot;&quot;&quot;Used to execute mono and multiview classification and result analysis for one random state</span>
<span class="c1">#          classification&quot;&quot;&quot;</span>
<span class="c1">#     #TODO : Clarify this one</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#     argumentDictionaries = initMultiviewArguments(args, benchmark, views, viewsIndices, argumentDictionaries,</span>
<span class="c1">#                                                   randomState, directory, resultsMonoview, classificationIndices)</span>
<span class="c1">#</span>
<span class="c1">#     resultsMultiview = []</span>
<span class="c1">#     if nbCores &gt; 1:</span>
<span class="c1">#         nbExperiments = len(argumentDictionaries[&quot;Multiview&quot;])</span>
<span class="c1">#         for stepIndex in range(int(math.ceil(float(nbExperiments) / nbCores))):</span>
<span class="c1">#             resultsMultiview += Parallel(n_jobs=nbCores)(</span>
<span class="c1">#                 delayed(ExecMultiview_multicore)(directory, coreIndex, args.name, classificationIndices, kFolds,</span>
<span class="c1">#                                                  args.type,</span>
<span class="c1">#                                                  args.pathF,</span>
<span class="c1">#                                                  LABELS_DICTIONARY, randomState, hyperParamSearch=hyperParamSearch,</span>
<span class="c1">#                                                  metrics=metrics, nIter=args.CL_HPS_iter,</span>
<span class="c1">#                                                  **argumentDictionaries[&quot;Multiview&quot;][stepIndex * nbCores + coreIndex])</span>
<span class="c1">#                 for coreIndex in range(min(nbCores, nbExperiments - stepIndex * nbCores)))</span>
<span class="c1">#     else:</span>
<span class="c1">#         resultsMultiview = [</span>
<span class="c1">#             ExecMultiview(directory, DATASET, args.name, classificationIndices, kFolds, 1, args.type, args.pathF,</span>
<span class="c1">#                           LABELS_DICTIONARY, randomState, hyperParamSearch=hyperParamSearch,</span>
<span class="c1">#                           metrics=metrics, nIter=args.CL_HPS_iter, **arguments) for arguments in</span>
<span class="c1">#             argumentDictionaries[&quot;Multiview&quot;]]</span>
<span class="c1">#     multiviewTime = time.time() - monoviewTime - dataBaseTime - start</span>
<span class="c1">#     if nbCores &gt; 1:</span>
<span class="c1">#         logging.debug(&quot;Start:\t Deleting &quot; + str(nbCores) + &quot; temporary datasets for multiprocessing&quot;)</span>
<span class="c1">#         datasetFiles = DB.deleteHDF5(args.pathF, args.name, nbCores)</span>
<span class="c1">#         logging.debug(&quot;Start:\t Deleting datasets for multiprocessing&quot;)</span>
<span class="c1">#     labels = np.array(</span>
<span class="c1">#         [resultMonoview[1][3] for resultMonoview in resultsMonoview] + [resultMultiview[3] for resultMultiview in</span>
<span class="c1">#                                                                         resultsMultiview]).transpose()</span>
<span class="c1">#     trueLabels = DATASET.get(&quot;Labels&quot;).value</span>
<span class="c1">#     times = [dataBaseTime, monoviewTime, multiviewTime]</span>
<span class="c1">#     results = (resultsMonoview, resultsMultiview)</span>
<span class="c1">#     labelAnalysis = analyzeLabels(labels, trueLabels, results, directory)</span>
<span class="c1">#     logging.debug(&quot;Start:\t Analyze Iteration Results&quot;)</span>
<span class="c1">#     resultAnalysis(benchmark, results, args.name, times, metrics, directory)</span>
<span class="c1">#     logging.debug(&quot;Done:\t Analyze Iteration Results&quot;)</span>
<span class="c1">#     globalAnalysisTime = time.time() - monoviewTime - dataBaseTime - start - multiviewTime</span>
<span class="c1">#     totalTime = time.time() - start</span>
<span class="c1">#     logging.info(&quot;Extraction time : &quot; + str(int(dataBaseTime)) +</span>
<span class="c1">#                  &quot;s, Monoview time : &quot; + str(int(monoviewTime)) +</span>
<span class="c1">#                  &quot;s, Multiview Time : &quot; + str(int(multiviewTime)) +</span>
<span class="c1">#                  &quot;s, Iteration Analysis Time : &quot; + str(int(globalAnalysisTime)) +</span>
<span class="c1">#                  &quot;s, Iteration Duration : &quot; + str(int(totalTime)) + &quot;s&quot;)</span>
<span class="c1">#     return results, labelAnalysis</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1"># if statsIter &gt; 1:</span>
    <span class="c1">#     logging.debug(&quot;Start:\t Benchmark classification&quot;)</span>
    <span class="c1">#     for statIterIndex in range(statsIter):</span>
    <span class="c1">#         if not os.path.exists(os.path.dirname(directories[statIterIndex] + &quot;train_labels.csv&quot;)):</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 os.makedirs(os.path.dirname(directories[statIterIndex] + &quot;train_labels.csv&quot;))</span>
    <span class="c1">#             except OSError as exc:</span>
    <span class="c1">#                 if exc.errno != errno.EEXIST:</span>
    <span class="c1">#                     raise</span>
    <span class="c1">#         trainIndices, testIndices = classificationIndices[statIterIndex]</span>
    <span class="c1">#         trainLabels = DATASET.get(&quot;Labels&quot;).value[trainIndices]</span>
    <span class="c1">#         np.savetxt(directories[statIterIndex] + &quot;train_labels.csv&quot;, trainLabels, delimiter=&quot;,&quot;)</span>
    <span class="c1">#     if nbCores &gt; 1:</span>
    <span class="c1">#         iterResults = []</span>
    <span class="c1">#         nbExperiments = statsIter*len(multiclassLabels)</span>
    <span class="c1">#         for stepIndex in range(int(math.ceil(float(nbExperiments) / nbCores))):</span>
    <span class="c1">#             iterResults += (Parallel(n_jobs=nbCores)(</span>
    <span class="c1">#                 delayed(classifyOneIter_multicore)(LABELS_DICTIONARY, argumentDictionaries, 1,</span>
    <span class="c1">#                                                    directories[coreIndex + stepIndex * nbCores], args,</span>
    <span class="c1">#                                                    classificationIndices[coreIndex + stepIndex * nbCores],</span>
    <span class="c1">#                                                    kFolds[coreIndex + stepIndex * nbCores],</span>
    <span class="c1">#                                                    statsIterRandomStates[coreIndex + stepIndex * nbCores],</span>
    <span class="c1">#                                                    hyperParamSearch, metrics, coreIndex, viewsIndices, dataBaseTime,</span>
    <span class="c1">#                                                    start, benchmark,</span>
    <span class="c1">#                                                    views)</span>
    <span class="c1">#                 for coreIndex in range(min(nbCores, nbExperiments - stepIndex * nbCores))))</span>
    <span class="c1">#         logging.debug(&quot;Start:\t Deleting &quot; + str(nbCores) + &quot; temporary datasets for multiprocessing&quot;)</span>
    <span class="c1">#         datasetFiles = DB.deleteHDF5(args.pathF, args.name, nbCores)</span>
    <span class="c1">#         logging.debug(&quot;Start:\t Deleting datasets for multiprocessing&quot;)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         iterResults = []</span>
    <span class="c1">#         for iterIndex in range(statsIter):</span>
    <span class="c1">#             if not os.path.exists(os.path.dirname(directories[iterIndex] + &quot;train_labels.csv&quot;)):</span>
    <span class="c1">#                 try:</span>
    <span class="c1">#                     os.makedirs(os.path.dirname(directories[iterIndex] + &quot;train_labels.csv&quot;))</span>
    <span class="c1">#                 except OSError as exc:</span>
    <span class="c1">#                     if exc.errno != errno.EEXIST:</span>
    <span class="c1">#                         raise</span>
    <span class="c1">#             trainIndices, testIndices = classificationIndices[iterIndex]</span>
    <span class="c1">#             trainLabels = DATASET.get(&quot;Labels&quot;).value[trainIndices]</span>
    <span class="c1">#             np.savetxt(directories[iterIndex] + &quot;train_labels.csv&quot;, trainLabels, delimiter=&quot;,&quot;)</span>
    <span class="c1">#             iterResults.append(</span>
    <span class="c1">#                 classifyOneIter(LABELS_DICTIONARY, argumentDictionaries, nbCores, directories[iterIndex], args,</span>
    <span class="c1">#                                 classificationIndices[iterIndex], kFolds[iterIndex], statsIterRandomStates[iterIndex],</span>
    <span class="c1">#                                 hyperParamSearch, metrics, DATASET, viewsIndices, dataBaseTime, start, benchmark,</span>
    <span class="c1">#                                 views))</span>
    <span class="c1">#     logging.debug(&quot;Done:\t Benchmark classification&quot;)</span>
    <span class="c1">#     logging.debug(&quot;Start:\t Global Results Analysis&quot;)</span>
    <span class="c1">#     classifiersIterResults = []</span>
    <span class="c1">#     iterLabelAnalysis = []</span>
    <span class="c1">#     for result in iterResults:</span>
    <span class="c1">#         classifiersIterResults.append(result[0])</span>
    <span class="c1">#         iterLabelAnalysis.append(result[1])</span>
    <span class="c1">#</span>
    <span class="c1">#     mono,multi = classifiersIterResults[0]</span>
    <span class="c1">#     classifiersNames = genNamesFromRes(mono, multi)</span>
    <span class="c1">#     analyzeIterLabels(iterLabelAnalysis, directory, classifiersNames)</span>
    <span class="c1">#     analyzeIterResults(classifiersIterResults, args.name, metrics, directory)</span>
    <span class="c1">#     logging.debug(&quot;Done:\t Global Results Analysis&quot;)</span>
    <span class="c1">#     totalDur = time.time() - start</span>
    <span class="c1">#     m, s = divmod(totalDur, 60)</span>
    <span class="c1">#     h, m = divmod(m, 60)</span>
    <span class="c1">#     d, h = divmod(h, 24)</span>
    <span class="c1">#     # print &quot;%d_%02d_%02d&quot; % (h, m, s)</span>
    <span class="c1">#     logging.info(&quot;Info:\t Total duration : &quot; + str(d) + &quot; days, &quot; + str(h) + &quot; hours, &quot; + str(m) + &quot; mins, &quot; + str(</span>
    <span class="c1">#         int(s)) + &quot;secs.&quot;)</span>
    <span class="c1">#</span>
    <span class="c1"># else:</span>
    <span class="c1">#     logging.debug(&quot;Start:\t Benchmark classification&quot;)</span>
    <span class="c1">#     if not os.path.exists(os.path.dirname(directories + &quot;train_labels.csv&quot;)):</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             os.makedirs(os.path.dirname(directories + &quot;train_labels.csv&quot;))</span>
    <span class="c1">#         except OSError as exc:</span>
    <span class="c1">#             if exc.errno != errno.EEXIST:</span>
    <span class="c1">#                 raise</span>
    <span class="c1">#     trainIndices, testIndices = classificationIndices</span>
    <span class="c1">#     trainLabels = DATASET.get(&quot;Labels&quot;).value[trainIndices]</span>
    <span class="c1">#     np.savetxt(directories + &quot;train_labels.csv&quot;, trainLabels, delimiter=&quot;,&quot;)</span>
    <span class="c1">#     res, labelAnalysis = classifyOneIter(LABELS_DICTIONARY, argumentDictionaries, nbCores, directories, args, classificationIndices,</span>
    <span class="c1">#                                          kFolds,</span>
    <span class="c1">#                                          statsIterRandomStates, hyperParamSearch, metrics, DATASET, viewsIndices, dataBaseTime, start,</span>
    <span class="c1">#                                          benchmark, views)</span>
    <span class="c1">#     logging.debug(&quot;Done:\t Benchmark classification&quot;)</span>
    <span class="c1">#     totalDur = time.time()-start</span>
    <span class="c1">#     m, s = divmod(totalDur, 60)</span>
    <span class="c1">#     h, m = divmod(m, 60)</span>
    <span class="c1">#     d, h = divmod(h, 24)</span>
    <span class="c1">#     # print &quot;%d_%02d_%02d&quot; % (h, m, s)</span>
    <span class="c1">#     logging.info(&quot;Info:\t Total duration : &quot;+str(d)+ &quot; days, &quot;+str(h)+&quot; hours, &quot;+str(m)+&quot; mins, &quot;+str(int(s))+&quot;secs.&quot;)</span>
    <span class="c1">#</span>
    <span class="c1"># if statsIter &gt; 1:</span>
    <span class="c1">#     pass</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Baptiste BAUVIN.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/language_data.js"></script>

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>